<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VpasModule</title>
  <link rel="stylesheet" href="assets/css/main.css"/>
  <link rel="icon" type="image/x-icon" href="images/favicon_theme.ico">
</head>
<body>
	<header style="background-color:#000;">
	  <div class="container nav" style="align-items:center; padding:8px 0;">
		<a class="brand" href="#top" style="display:flex;align-items:center;gap:50px;text-decoration:none;">
		  <div class="logo" style="background:none;padding:0;">
			<img src="images/VpasModuleLOGONoText_theme.png" alt="VPASModule logo" style="height:68px;display:block;">
		  </div>
		  <div style="margin-left:10px;">
			<div class="name" style="font-weight:700;color:#fff;">VpasModule</div>
			<div class="muted" style="font-size:12px;color:#ccc;">PowerShell module for CyberArk APIs</div>
		  </div>
		</a>
		<nav class="navlinks">
		  <a href="install.html">Install</a>
		  <a href="commands.html">Commands</a>
		  <a href="scriptbuilder.html">ScriptBuilder</a>
		  <a href="common.html">Common Scripts</a>
		  <a href="updates.html">Updates</a>
		  <a href="about.html">About</a>
		  <a href="https://docs.cyberark.com" target="_blank" rel="noopener">Docs</a>
		</nav>
	  </div>
	</header>

  <main id="top">
    <!-- Hero -->
    <section class="hero">
      <div class="container grid grid-2" style="gap:22px">
        <div>
          <h1>Automate Cyberark tasks with <span class="gradient">VpasModule</span></h1>
          <p class="muted" style="margin-top:10px">
            A simplified PowerShell module to interact with CyberArk Web Services
          </p>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:16px">
            <a href="install.html" class="btn btn-primary">Install & Get Started</a>
            <a href="scriptbuilder.html" class="btn btn-ghost">Try ScriptBuilder (beta)</a>
          </div>
          <p class="muted" style="margin-top:10px;font-size:12px">
            Quick links: <a class="gradient" href="common.html" style="text-decoration:underline">Common Scripts</a> • <a class="gradient" href="commands.html" style="text-decoration:underline">Commands</a> • <a class="gradient" href="https://docs.cyberark.com" target="_blank" rel="noopener" style="text-decoration:underline">Official Cyberark Docs</a>
          </p>
        </div>
      </div>
    </section>

    <!-- Feature cards -->
    <section class="container section grid grid-3">
      <article class="card card-body">
        <h3>Install</h3>
        <p class="muted">Install VpasModule from PowerShell Gallery or GitHub and start automating</p>
        <a href="install.html" class="btn btn-chip" style="margin-top:10px">View</a>
      </article>
      <article class="card card-body">
        <h3>Commands</h3>
        <p class="muted">Full list of cmdlets, with syntax, examples, and parameter details</p>
        <a href="commands.html" class="btn btn-chip" style="margin-top:10px">Browse</a>
      </article>
      <article class="card card-body">
        <h3>ScriptBuilder (Beta)</h3>
        <p class="muted">Generate and copy a script with values provided by you</p>
        <a href="scriptbuilder.html" class="btn btn-chip" style="margin-top:10px">Open</a>
      </article>
      <article id="common" class="card card-body" style="border-color:#3b3ee0;background:linear-gradient(135deg,rgba(20,30,60,.45),rgba(10,18,44,.45))">
        <h3>Common Scripts</h3>
        <p class="muted">Curated, copy‑ready scripts for frequent use cases</p>
        <a href="common.html" class="btn btn-primary" style="margin-top:10px">Explore</a>
      </article>
      <article class="card card-body">
        <h3>Updates & Changelog</h3>
        <p class="muted">See what's new - version notes and breaking changes</p>
        <a href="updates.html" class="btn btn-chip" style="margin-top:10px">View</a>
      </article>
	  <article class="card card-body">
        <h3>About</h3>
        <p class="muted">How VpasModule came to be & contact information</p>
        <a href="updates.html" class="btn btn-chip" style="margin-top:10px">View</a>
      </article>
      <article class="card card-body">
        <h3>Documentation</h3>
        <p class="muted">Official CyberArk documentation</p>
        <a href="https://docs.cyberark.com" target="_blank" rel="noopener" class="btn btn-chip" style="margin-top:10px">Open Docs</a>
      </article>
    </section>


    <!-- Updates + Docs -->
    <section class="section container">
	  <article id="updates" class="card card-body">
		<h3 style="margin-bottom:16px;">
		  Latest Changelog <span class="badge">v14.6.0</span>
		</h3>
		
		<div style="display:grid; grid-template-columns:repeat(3, 1fr); gap:20px;">
		  
		  <!-- Column 1 -->
		  <div style="border-right:1px solid var(--border); padding-right:16px;">
		  <h4 style="margin-top:0;">New Commands</h4>
			<ul style="margin:0 0 0 16px; padding:0;">
				<li style="margin-top:6px">PAM:</li>
				<ul>
					<li style="margin-top:6px">New-VPASMFACacheSSHKey: Generate a new MFA Cache SSH Key for current user or on behalf of another user</li>
					<li style="margin-top:6px">Remove-VPASMFACacheSSHKey: Remove an MFA cache SSH Key for current user, on behalf of a user, or for all users</li>
					<li style="margin-top:6px">Get-VPASStoredPlatformDetails: Retrieve details for a temporarily stored platform</li>
					<li style="margin-top:6px">Remove-VPASStoredPlatform: Delete a temporarily stored platform</li>
					<li style="margin-top:6px">Set-VPASStoredPlatform: Overwrites a platform with the temporarily stored platform</li>
					<li style="margin-top:6px">Import-VPASStoredPlatform: Import a stored platform with new values to clear platform conflict</li>
					<li style="margin-top:6px">Get-VPASMasterPolicySettings: Retrieve Master Policy settings for a target platform</li>
					<li style="margin-top:6px">Update-VPASMasterPolicySettings: Update Master Policy setting for a target platform</li>
					<li style="margin-top:6px">Get-VPASAllMasterPolicySettings: Retrieve Master Policy settings for all target platforms</li>
					<li style="margin-top:6px">Get-VPASAllDependentAccounts: Retrieve all dependent accounts (usages) in the environment</li>
					<li style="margin-top:6px">Get-VPASDependentAccounts: Retrieve dependent accounts (usages) attached to an account</li>
					<li style="margin-top:6px">Get-VPASDependentAccountDetails: Retrieve details for a dependent account (usages)</li>
					<li style="margin-top:6px">Add-VPASDependentAccount: Add a dependent account (usage)</li>
					<li style="margin-top:6px">Remove-VPASDependentAccount: Remove a dependent account (usage)</li>
					<li style="margin-top:6px">Resume-VPASDependentAccount: Resume a dependent account (usage) that has been disabled by either CPM or user</li>
					<li style="margin-top:6px">Push-VPASDependentAccountSecret: Push or Sync a secret to a dependent account (usage)</li>
					<li style="margin-top:6px">Update-VPASDependentAccount: update a property for a dependent account (usage)</li>
					<li style="margin-top:6px">Add-VPASOnboardingRule: Add an onboarding rule for automatic onboarding</li>
					<li style="margin-top:6px">Get-VPASAllOnboardingRules: Retrieve all onboarding rules for automatic onboarding in the environment</li>
					<li style="margin-top:6px">Get-VPASOnboardingRules: Retrieve onboarding rules for automatic onboarding in the environment via search query</li>
					<li style="margin-top:6px">Remove-VPASOnboardingRule: delete an existing onboarding rule for automatic onboarding in the environment</li>
					<li style="margin-top:6px">Get-VPASAllReports: Retrieve all reports available to the current user</li>
					<li style="margin-top:6px">Get-VPASAllTasks: Retrieve all scheduled reports available to the current user</li>
				</ul>
				<li style="margin-top:6px">Identity:</li>
				<ul>
					<li style="margin-top:6px">Get-VPASIdentityAllApplicationTemplates: Retrieve all application templates from Identity</li>
					<li style="margin-top:6px">Get-VPASIdentityApplicationTemplates: Retrieve application templates from Identity based on a search query</li>
					<li style="margin-top:6px">Get-VPASIdentityApplicationDetails: Retrieve details for an application in Identity</li>
					<li style="margin-top:6px">Get-VPASIdentityAllApplications: Retrieve details for all applications in Identity</li>
					<li style="margin-top:6px">Get-VPASIdentityApplications: Retrieve details for an application in Identity based on a search query</li>
					<li style="margin-top:6px">Test-VPASIdentityApplicationCatalog: Tests to see if the application is still available in the application catalog</li>
				</ul>
			</ul>
		  </div>
		  
		  <!-- Column 2 -->
		  <div style="border-right:1px solid var(--border); padding:0 16px;">
			<h4 style="margin-top:0;">Bug Fixes</h4>
			<ul style="margin:0 0 0 16px; padding:0;">
				<li style="margin-top:6px">Invoke-VPASCredentialProvider: fixed bug if password being pulled contained a comma would return incorrect values</li>
				<li style="margin-top:6px">Update-VPASAccountFields: fixed case sensitivity issue that prevented updating "RemoteMachinesAccess" parameter for an account</li>
				<li style="margin-top:6px">Updated the metrics output and graphs for the following commands:</li>
					<ul>
						<li style="margin-top:6px">Invoke-VPASMetricsAccounts</li>
						<li style="margin-top:6px">Invoke-VPASMetricsCPM</li>
						<li style="margin-top:6px">Invoke-VPASMetricsPlatforms</li>
						<li style="margin-top:6px">Invoke-VPASMetricsProviders</li>
						<li style="margin-top:6px">Invoke-VPASMetricsPSM</li>
					</ul>
				<li style="margin-top:6px">Get-VPASAllPlatforms: fixed bug where -ExportToCSV would display incorrect information if Get-VPASAllTargetPlatforms was run instead</li>
				<li style="margin-top:6px">Remove-VPASAuthenticationMethod: fixed bug where -WhatIf did not function correctly if the target authentication method does not exist</li>
			</ul>
		  </div>
		  
		  <!-- Column 3 -->
		  <div style="padding-left:16px;">
			<h4 style="margin-top:0;">Script Breaking Changes</h4>
			<ul style="margin:0 0 0 16px; padding:0;">
				<li style="margin-top:6px">None</li>
			</ul>
		  </div>
		  
		</div>
	  </article>
	</section>
  </main>

  <footer>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:16px;flex-wrap:wrap">
      <div><strong>VPASModule</strong><div class="muted" style="margin-top:6px">© <span id="year"></span> Your Name • <a href="#">License</a></div></div>
      <div style="display:flex;gap:8px">
        <a class="btn btn-chip" href="https://github.com" target="_blank" rel="noopener">GitHub</a>
        <a class="btn btn-chip" href="https://www.powershellgallery.com" target="_blank" rel="noopener">PowerShell Gallery</a>
        <a class="btn btn-chip" href="#">Contact</a>
      </div>
    </div>
  </footer>

  <!-- Overlays -->
  <div id="palette" class="dialog hidden" aria-hidden="true">
    <div class="backdrop" data-close="palette"></div>
    <div class="panel">
      <h3 class="title">Command Palette <span class="muted" style="font-size:12px">(⌘/Ctrl+K)</span></h3>
      <input id="paletteSearch" class="search" placeholder="Search commands, scripts, actions…"/>
      <div id="paletteList" class="list" style="margin-top:10px"></div>
    </div>
  </div>

  <div id="cmdDialog" class="dialog hidden" aria-hidden="true">
    <div class="backdrop" data-close="cmdDialog"></div>
    <div class="panel">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px">
        <h3 id="cmdTitle" class="title" style="margin:0"></h3>
        <button class="btn btn-chip btn-xs" data-close="cmdDialog">Close</button>
      </div>
      <div id="cmdBody"></div>
    </div>
  </div>

  <script>

    // ---------- Utilities ----------
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    function copyFrom(targetSel){
      const el = document.querySelector(targetSel);
      if(!el) return;
      const text = el.innerText;
      navigator.clipboard.writeText(text).then(()=>{
        const btns = $$(`[data-copy-target="${targetSel}"]`);
        btns.forEach(b => { b.classList.add('ok'); b.textContent = 'Copied!'; setTimeout(()=>{b.classList.remove('ok'); b.textContent='Copy';}, 1200); });
      }).catch(()=>{});
    }

    // Click handlers (copy + close dialogs)
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.btn[data-copy-target]');
      if(btn){ e.preventDefault(); copyFrom(btn.getAttribute('data-copy-target')); }
      if(e.target.matches('[data-close]')){
        const id = e.target.getAttribute('data-close');
        document.getElementById(id)?.classList.add('hidden');
      }
      if(e.target.matches('.backdrop[data-close]')){
        const id = e.target.getAttribute('data-close');
        document.getElementById(id)?.classList.add('hidden');
      }
    });

    // Footer year
    const yr = $('#year'); if (yr) yr.textContent = new Date().getFullYear();

    // Minimal keyboard handling (Escape closes dialogs)
    document.addEventListener('keydown', (e)=>{
      if(e.key === 'Escape'){
        $('#palette')?.classList.add('hidden');
        $('#cmdDialog')?.classList.add('hidden');
      }
    });

    // Smooth scroll for anchors
    document.addEventListener('click', (e)=>{
      const a = e.target.closest('a[href^="#"]');
      if(!a) return;
      const id = a.getAttribute('href').slice(1);
      const target = document.getElementById(id);
      if(target){ e.preventDefault(); target.scrollIntoView({behavior:'smooth',block:'start'}); }
    });

</script>
</body>
</html>
